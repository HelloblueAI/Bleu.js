# ðŸ”’ Vulnerability Fixes Applied

## High Severity Vulnerabilities Analysis

### Fixable (Can Fix Now):
1. âœ… **CVE-2025-47273** - setuptools@70.3.0 (CVSS 7.7)
   - **Fix Version:** 78.1.1
   - **Status:** âœ… **FIXED** - Updated to setuptools>=78.1.1

2. âœ… **CVE-2025-8869** - pip@24.0 (CVSS 5.9 - Medium, but fixable)
   - **Fix Version:** 25.3
   - **Status:** âœ… **FIXED** - Updated to pip>=25.3

3. âœ… **CVE-2025-15467** - alpine/openssl 3.3.5-r0 (CVSS 9.8 Critical)
   - **Fix Version:** openssl 3.3.6-r0 (Alpine 3.23.3+)
   - **Status:** âœ… **FIXED** - Base image Alpine 3.23.3, `apk upgrade` in all Dockerfiles

4. âœ… **CVE-2026-21441** - pypi/urllib3 2.6.2 (CVSS 8.9)
   - **Fix Version:** urllib3>=2.6.3
   - **Status:** âœ… **FIXED** - Explicit `pip install "urllib3>=2.6.3"` in all Dockerfiles

5. âœ… **CVE-2026-24049** - pypi/wheel 0.45.1 (CVSS 7.1)
   - **Fix Version:** wheel>=0.46.3
   - **Status:** âœ… **FIXED** - Explicit `pip install "wheel>=0.46.3"` in all Dockerfiles

### Resolved via Alpine 3.23.3 (apk upgrade):
- âœ… **CVE-2025-31498** - c-ares (Alpine 3.23.3+)
- âœ… **CVE-2025-6965** / **CVE-2025-3277** - sqlite (Alpine 3.23.3+)
- âœ… **CVE-2025-69419** / **CVE-2025-69420** - openssl (Alpine 3.23.3+)
- âœ… **CVE-2025-60876** - busybox (Alpine 3.23.3+)
- âœ… **CVE-2025-14017** - curl (Alpine 3.23.3+)

---

## Fixes Applied

### 1. âœ… Updated setuptools
**Before:** setuptools (latest, was 70.3.0)
**After:** setuptools>=78.1.1

**Location:** `bleu-os/Dockerfile.production` (builder stage)

**Impact:** Fixes CVE-2025-47273 (High severity, CVSS 7.7)

---

### 2. âœ… Updated pip
**Before:** pip (latest, was 24.0)
**After:** pip>=25.3

**Location:** `bleu-os/Dockerfile.production` (builder stage)

**Impact:** Fixes CVE-2025-8869 (Medium severity, CVSS 5.9)

---

### 3. âœ… Upgraded base image to Alpine 3.23 / 3.23.3
**Before:** alpine:3.19 / alpine:3.20
**After:** alpine:3.23 (main/minimal/improved/optimized), alpine:3.23.3 (production)

**Locations:** All `bleu-os/Dockerfile*` files

**Impact:** Fixes CVE-2025-15467, CVE-2025-69419, CVE-2025-69420 (openssl), CVE-2025-31498 (c-ares), CVE-2025-6965, CVE-2025-3277 (sqlite), CVE-2025-60876 (busybox), CVE-2025-14017 (curl). All stages now run `apk update && apk upgrade --no-cache` and `apk add --no-cache --upgrade` for packages.

---

### 4. âœ… Pinned urllib3 and wheel (PyPI)
**Before:** urllib3 2.6.2, wheel 0.45.1 (from transitive installs)
**After:** urllib3>=2.6.3, wheel>=0.46.3 (explicit upgrade in Dockerfiles)

**Locations:** All `bleu-os/Dockerfile*` (pip install step)

**Impact:** Fixes CVE-2026-21441 (urllib3), CVE-2026-24049 (wheel).

---

## Expected Results After Next Build

### Fixable Vulnerabilities (addressed):
- âœ… **setuptools CVE-2025-47273** â†’ Resolved
- âœ… **pip CVE-2025-8869** â†’ Resolved
- âœ… **openssl CVE-2025-15467, CVE-2025-69419, CVE-2025-69420** â†’ Resolved (Alpine 3.23.3)
- âœ… **urllib3 CVE-2026-21441** â†’ Resolved (urllib3>=2.6.3)
- âœ… **wheel CVE-2026-24049** â†’ Resolved (wheel>=0.46.3)
- âœ… **c-ares, sqlite, busybox, curl** (Alpine CVEs) â†’ Resolved via Alpine 3.23.3 + apk upgrade

### Grade Improvement:
- **After rebuild:** Docker Scout should show fewer/no fixable vulnerabilities when using the updated Dockerfiles (Alpine 3.23.3 + explicit pip upgrades).

---

## Files Modified (January 2026 CVE round)

1. âœ… `bleu-os/Dockerfile` â€“ Alpine 3.19â†’3.23, `apk upgrade --no-cache`, pip/setuptools/urllib3/wheel upgrades
2. âœ… `bleu-os/Dockerfile.production` â€“ Alpine 3.23â†’3.23.3 (both stages), explicit urllib3>=2.6.3, wheel>=0.46.3
3. âœ… `bleu-os/Dockerfile.improved` â€“ Alpine 3.19â†’3.23 (both stages), apk upgrade, urllib3/wheel upgrades
4. âœ… `bleu-os/Dockerfile.optimized` â€“ Alpine 3.19â†’3.23 (both stages), apk upgrade, urllib3/wheel upgrades
5. âœ… `bleu-os/Dockerfile.minimal` â€“ pip/setuptools/urllib3/wheel version constraints (already on Alpine 3.23)

---

## Next Steps

1. **Rebuild images** â€“ Use the updated Dockerfile (or Dockerfile.production for production). From repo root:
   `docker build -f bleu-os/Dockerfile -t bleuos/bleu-os:latest .` or
   `docker build -f bleu-os/Dockerfile.production -t bleuos/bleu-os:latest .`
2. **Verify** â€“ Re-scan with Docker Scout; fixable CVEs (openssl, urllib3, wheel, and other Alpine packages) should clear.
3. **Monitor** â€“ Keep base at Alpine 3.23.x and run `apk upgrade` in builds so future Alpine CVEs are picked up.

---

**Last Updated:** 2026-01-29
**Status:** âœ… Critical/High fixable vulnerabilities addressed (Alpine 3.23.3 + urllib3/wheel pins)
